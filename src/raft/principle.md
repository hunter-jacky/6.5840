



1. 与身份相关的行为（appendEntries，election），必须密切关注自己的身份是否变化，特别是在每次等待获取到锁以后，需要重新判断状态是否变更，可能存在在等待锁的过程中状态已经发生变更的情况


2. 变为candidate后，即state发生变化后，term必须立马跟着改变。否则在两者之间，被其他情况抢到锁（例如给别人投票），导致term发生变化，然后再次抢到锁，使得term在错误的情况下+1。
可能会觉得，可以在第二次抢到锁对term+1前进行判断，但是这样仍然会出现candidate状态下以原来的term对他人进行投票的情况。

3. voteFor的处理：
    1. 每个server在每个term内只能投一次票。
    2. voteFor的改变分为重置为-1，和给人投票两种情况。
    3. 重置为-1``只能且必须``发生在自己的term变化后（1. 变为candidate；2.收到高term的entries或者voteRequest）。
    4. 给人投票前必须保证自己的voteFor为-1，即在当前term期间未投过票。给自己的投票也是一样。
    5. 具体的，可以在变为candidate后，改变state和term后也将其置为rf.me（同时完成重置和投票行为），这样后续抢锁进行集票时，就可以直接跳过对自己的投票。也可以在变为candidate后，先将voteFor置为-1。这样再后续抢锁集票时，对自己的投票也需要进行判断是否已经投过票。


